var buildTable=function(a,b,e){var d="breakdown_row"+b.replace(/\/\.\./g,"").replace(/\//g,"_");var c=jQuery("<tbody/>");if(e==undefined){e="table";jQuery(e+" > tbody > tr").each(function(){c.append(this);if(a==jQuery(this).attr("charoff")){var g=jQuery("<td/>").attr("colspan","20");g.append(jQuery("<div/>").attr("class","desglose").load(b,function(){jQuery("img.breakdown_icon",this).bind("click",breakdown);jQuery("img.seleccionar",this).hide()}));var f=jQuery("<tr/>").addClass(d).addClass("breakdown_row").append(g);c.append(f)}});jQuery(e+" > tbody").remove();jQuery(e).append(c)}else{e.parent().find("table:first > tbody > tr").each(function(){c.append(this);if(a==jQuery(this).attr("charoff")){var g=jQuery("<td/>").attr("colspan","20");g.append(jQuery("<div/>").attr("class","desglose").load(b,function(){jQuery("img.breakdown_icon",this).bind("click",breakdown);jQuery("img.seleccionar",this).hide()}));var f=jQuery("<tr/>").addClass(d).addClass("breakdown_row").append(g);c.append(f)}});e.find("tbody").remove();e.append(c)}return false};var closeAllBreakdowns=function(){jQuery.cookie("breakDownsCookie",null);jQuery(".breakdown_row").hide();return false};jQuery(document).ready(function(e){jQuery("#closeAllBreakdowns").bind("click",closeAllBreakdowns);var a=jQuery.cookie("breakDownsCookie");if(a!=null){breakDowns=a.split("|").clean("");var c=0;var b="";jQuery(".breakdown_icon").each(function(f){if(jQuery.inArray(this.getAttribute("longdesc"),breakDowns)>=0){c++;b=this.getAttribute("longdesc");clickedRowId=this.getAttribute("longdesc").split("/").pop();buildTable(clickedRowId,this.getAttribute("longdesc"))}});jQuery(".bread_crumb_class").remove();if(c==1){var d=jQuery("<span/>").addClass("bread_crumb_class").text(" » "+jQuery("img[longdesc='"+b+"']").attr("alt"));jQuery("div.banda_izquierda > p").append(d)}else{if(c>1){var d=jQuery("<span/>").addClass("bread_crumb_class").text(" » "+breakDowns.length+" Desgloses abiertos");jQuery("div.banda_izquierda > p").append(d)}}}});var breakdown=function(){var b=jQuery(this).parent().parent().attr("charoff");var c=this.getAttribute("longdesc");var a=jQuery.cookie("breakDownsCookie");if(a!=null){breakDowns=a.split("|").clean("")}else{breakDowns=Array()}var f="breakdown_row"+c.replace(/\/\.\./g,"").replace(/\//g,"_");if(jQuery("."+f).length){jQuery("."+f).toggle();if(!jQuery("."+f).is(":visible")){delete breakDowns[jQuery.inArray(c,breakDowns)];breakDowns=breakDowns.clean("").clean(undefined);jQuery.cookie("breakDownsCookie",breakDowns.join("|"))}}else{breakDowns.push(c);jQuery.cookie("breakDownsCookie",breakDowns.join("|"));var e=jQuery(this).parent().parent().parent().parent();buildTable(b,c,e)}jQuery(".bread_crumb_class").remove();if(breakDowns.length==1){var d=jQuery("<span/>").addClass("bread_crumb_class").text(" » "+jQuery("img[longdesc='"+breakDowns[0]+"']").attr("alt"));jQuery("div.banda_izquierda > p").append(d)}else{if(breakDowns.length>1){var d=jQuery("<span/>").addClass("bread_crumb_class").text(" » "+breakDowns.length+" Desgloses abiertos");jQuery("div.banda_izquierda > p").append(d)}}};